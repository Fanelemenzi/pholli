{% for policy in policies %}
<div class="policy-card">
    <div class="row">
        <div class="col-md-8">
            <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="mb-1">{{ policy.name }}</h5>
                <span class="badge" style="background-color: #6f42c1;">Funeral</span>
            </div>
            
            <p class="text-muted small mb-2">
                <i class="fas fa-building me-1"></i>{{ policy.organization.name }}
            </p>
            
            <p class="mb-3">{{ policy.short_description|truncatewords:25 }}</p>
            
            <!-- Feature Display -->
            {% if policy.policy_features %}
            <div class="mb-3">
                <h6 class="small text-muted mb-2">FEATURES:</h6>
                <div class="features-list">
                    {% if policy.policy_features.cover_amount %}
                    <span class="feature-badge">
                        Cover: {{ policy.currency }} {{ policy.policy_features.cover_amount }}
                    </span>
                    {% endif %}
                    
                    {% if policy.policy_features.monthly_net_income %}
                    <span class="feature-badge requirement">
                        Income Req: {{ policy.currency }} {{ policy.policy_features.monthly_net_income }}
                    </span>
                    {% endif %}
                    
                    {% if policy.policy_features.marital_status_requirement %}
                    <span class="feature-badge requirement">
                        Marital: {{ policy.policy_features.marital_status_requirement|title }}
                    </span>
                    {% endif %}
                    
                    {% if policy.policy_features.gender_requirement %}
                    <span class="feature-badge requirement">
                        Gender: {{ policy.policy_features.gender_requirement|title }}
                    </span>
                    {% endif %}
                    
                    {% if policy.waiting_period_days %}
                    <span class="feature-badge">
                        Waiting: {{ policy.waiting_period_days }} days
                    </span>
                    {% endif %}
                </div>
            </div>
            {% endif %}
            
            <!-- Additional Features -->
            {% if policy.additional_features.all %}
            <div class="mb-2">
                <h6 class="small text-muted mb-1">ADDITIONAL BENEFITS:</h6>
                <div class="small">
                    {% for feature in policy.additional_features.all|slice:":3" %}
                    <span class="feature-badge available">
                        {{ feature.title }}
                    </span>
                    {% endfor %}
                    {% if policy.additional_features.count > 3 %}
                    <span class="text-muted small">
                        +{{ policy.additional_features.count|add:"-3" }} more
                    </span>
                    {% endif %}
                </div>
            </div>
            {% endif %}
        </div>
        
        <div class="col-md-4 text-end">
            <div class="mb-2">
                <small class="text-muted">Monthly Premium</small>
                <div class="h4 funeral-theme mb-1">
                    {{ policy.currency }} {{ policy.base_premium }}
                </div>
            </div>
            
            <div class="mb-3">
                <small class="text-muted">Coverage Amount</small>
                <div class="fw-bold">
                    {{ policy.currency }} {{ policy.coverage_amount }}
                </div>
            </div>
            
            {% if policy.waiting_period_days %}
            <div class="mb-3">
                <small class="text-muted">Waiting Period</small>
                <div class="small">
                    {{ policy.waiting_period_days }} days
                </div>
            </div>
            {% endif %}
            
            <div class="d-grid gap-2">
                <a href="{% url 'policies:policy_detail' policy.pk %}" 
                   class="btn btn-funeral">
                    View Details
                </a>
                <button class="btn btn-outline-secondary btn-sm" 
                        onclick="addToComparison({{ policy.pk }})">
                    <i class="fas fa-balance-scale me-1"></i>Compare
                </button>
            </div>
        </div>
    </div>
</div>
{% empty %}
<div class="no-results">
    <i class="fas fa-search fa-3x mb-3"></i>
    <h4>No funeral policies match your criteria</h4>
    <p class="mb-3">Try adjusting your filters to see more options:</p>
    <ul class="list-unstyled">
        <li>• Lower the minimum cover amount requirement</li>
        <li>• Increase the maximum income requirement</li>
        <li>• Allow longer waiting periods</li>
        <li>• Make demographic requirements optional</li>
        <li>• Clear all filters to see all funeral policies</li>
    </ul>
    <a href="{% url 'policies:funeral_policy_list' %}" class="btn btn-funeral">
        View All Funeral Policies
    </a>
</div>
{% endfor %}